name: foxglove-studio
summary: |
  Robotics data visualization and observability with Foxglove studio
description: |
  Foxglove Studio is an integrated visualization and diagnosis tool for robotics.
type: charm
assumes:
  - k8s-api
bases:
  - build-on:
    - name: ubuntu
      channel: "22.04"
    run-on:
    - name: ubuntu
      channel: "22.04"

charm-libs:
  - lib: traefik_route_k8s.traefik_route
    version: "0"
  - lib: catalogue_k8s.catalogue
    version: "0"

containers:
  foxglove-studio:
    resource: foxglove-studio-image

resources:
  foxglove-studio-image:
    type: oci-image
    description: upstream docker image for Foxglove studio
    upstream-source: ghcr.io/foxglove/studio:latest

requires:
  ingress:
    interface: traefik_route
    limit: 1
  catalogue:
    interface: catalogue

config:
  options:
    server-port:
      default: 8080
      description: Default port on which Foxglove-Studio is available
      type: int

parts: 
  charm:
    build-snaps: [rustup]
    override-build: |
      rustup default stable
      craftctl default
